vulnerability_id: CVE-2017-13772
affected_vendor: TP-Link
firmware_version: WR940N
firmware_architecture: MIPS32
file_system: Squashfs
vulnerability_type: Stack Overflow
vulnerability_score: 8.8
vulnerability_severity: High
CWE_type: CWE-119
communication_protocol: HTTP
simulation_method: FAT
vulnerability_description: Multiple stack-based buffer overflows in TP-Link WR940N WiFi routers with hardware version 4 allow remote authenticated users to execute arbitrary code via the (1) ping_addr parameter to PingIframeRpm.htm or (2) dnsserver2 parameter to WanStaticIpV6CfgRpm.htm.
firmware_link: https://github.com/VulnTotal-Team/IoT-vulhub/blob/master/TP-Link/CVE-2017-13772/firmware/wr940nv4_us_3_16_9_up_boot(160617).bin
fuzz_seed: |
  GET /DWFSOAYBSYXBAXRA/userRpm/PingIframeRpm.htm?ping_addr=127.0.0.1&doType=ping&isNew=new&sendNum=20&pSize=64&overTime=800&trHops=20 HTTP/1.1
  Host: 127.0.0.1:8081
  User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:76.0) Gecko/20100101 Firefox/76.0
  Accept-Encoding: gzip, deflate
  Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
  Connection: close
  Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
  Referer: http://127.0.0.1:8081/DWFSOAYBSYXBAXRA/userRpm/PingIframeRpm.htm
  Cookie: Authorization=Basic%20YWRtaW46MjEyMzJmMjk3YTU3YTVhNzQzODk0YTBlNGE4MDFmYzM%3D
  Upgrade-Insecure-Requests: 1
