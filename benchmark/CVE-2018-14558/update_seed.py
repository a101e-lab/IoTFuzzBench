import requests
import re

def get_new_token(target_ip,target_port):
    burp0_url = "http://"+target_ip+":"+str(target_port)+"/cgi-bin/get/New_GUI/get_sessionKey.asp"
    burp0_headers = {"User-Agent": "Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:107.0) Gecko/20100101 Firefox/107.0", "Accept": "text/plain, */*; q=0.01", "Accept-Language": "en-US,en;q=0.5", "Accept-Encoding": "gzip, deflate", "Content-Type": "application/x-www-form-urlencoded; charset=UTF-8", "X-Requested-With": "XMLHttpRequest", "Origin": "http://"+target_ip, "Connection": "close", "Referer": "http://"+target_ip+"/cgi-bin/New_GUI/Home.asp"}

    results = requests.get(burp0_url, headers=burp0_headers)
    results_str = results.text

    new_token = results_str

    return new_token

def set_new_token(seed,new_token):
    seed_begin = seed[:seed.find('Key')+4]
    seed_end = seed[seed.find('&Type')-0:]
    updated_seed = seed_begin + new_token + seed_end
    return updated_seed

def update_seed(seed='',target_ip = '192.168.1.1',target_port = 80):
#no need to update
    updated_seed=seed
    return updated_seed

if __name__ == '__main__':
    target_ip = '192.168.1.1'
    target_port = 80
    seed = '''GET /userRpm/PingIframeRpm.htm?ping_addr=zeroscience.mk&doType=ping&isNew=&lineNum=1 HTTP/1.1
Host: 192.168.1.1
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:32.0) Gecko/20100101 Firefox/32.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://192.168.0.1/userRpm/PingIframeRpm.htm?ping_addr=zeroscience.mk&doType=ping&isNew=new&sendNum=4&pSize=64&overTime=800&trHops=20
Authorization: Basic YWRtaW46YWRtaW4=
Connection: keep-alive


'''
    updated_seed = update_seed(seed,target_ip,target_port)
    print(updated_seed)
