vulnerability_id: CVE-2018-18708
affected_vendor: Tenda
firmware_version: AC7 V15.03.06.44_CN
firmware_architecture: ARM
file_system: Squashfs
vulnerability_type: Stack Overflow
vulnerability_score: 7.5
vulnerability_severity: High
CWE_type: CWE-119
communication_protocol: HTTP
simulation_method: qemu-arm-static
vulnerability_description: An issue was discovered on Tenda AC7 V15.03.06.44_CN, AC9 V15.03.05.19(6318)_CN, AC10 V15.03.06.23_CN, AC15 V15.03.05.19_CN, and AC18 V15.03.05.19(6318)_CN devices. It is a buffer overflow vulnerability in the router's web server -- httpd. When processing the "page" parameter of the function "fromAddressNat" for a post request, the value is directly used in a sprintf to a local variable placed on the stack, which overrides the return address of the function.
firmware_link: https://www.tenda.com.cn/download/detail-2682.html
fuzz_seed: |
  POST /goform/setMacFilterCfg HTTP/1.1
  Host: 192.168.3.8:8081
  Proxy-Connection: keep-alive
  Upgrade-Insecure-Requests: 1
  User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.61 Safari/537.36
  Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
  Accept-Encoding: gzip, deflate
  Accept-Language: zh-CN,zh-TW;q=0.9,zh;q=0.8,en-US;q=0.7,en;q=0.6
  Cookie: password=lqetgb
  Content-Length: 34

  macFilterType=white&deviceList=devices1