vulnerability_id: CVE-2019-17510
affected_vendor: D-Link
firmware_version: DIR-846
firmware_architecture: MIPS32
file_system: Squashfs
vulnerability_type: Command Injection
vulnerability_score: 9.8
vulnerability_severity: Critical
CWE_type: CWE-78
communication_protocol: HNAP
simulation_method: fat
vulnerability_description: D-Link DIR-846 devices with firmware 100A35 allow remote attackers to execute arbitrary OS commands as root by leveraging admin access and sending a /HNAP1/ request for SetWizardConfig with shell metacharacters to /squashfs-root/www/HNAP1/control/SetWizardConfig.php.
firmware_link: http://support.dlink.com.cn:9000/ProductInfo.aspx?m=DIR-846
fuzz_seed: |
  POST /HNAP1/ HTTP/1.1
  Host: 192.168.0.1
  User-Agent: Mozilla/5.0 (X11; Linux aarch64; rv:78.0) Gecko/20100101 Firefox/78.0
  Accept: application/json
  Accept-Language: en-US,en;q=0.5
  Accept-Encoding: gzip, deflate
  Content-Type: application/json
  SOAPACTION: "http://purenetworks.com/HNAP1/SetWizardConfig"
  HNAP_AUTH: 11583A1E429EF67F912D6EE6D079E244 1666080008220
  Content-Length: 77
  Origin: http://192.168.0.1
  Connection: close
  Referer: http://192.168.0.1/Parentcontrol.html?t=1666079999406
  Cookie: Authorization=Basic%20YWRtaW46MjEyMzJmMjk3YTU3YTVhNzQzODk0YTBlNGE4MDFmYzM%3D; SESSION_ID=2:1598955110:2; uid=GXUVzvPV; PrivateKey=7EC245C12637DC82AB0D61E5194799F8; timeout=0; PHPSESSID=eb73ebfa5417d36e1bafa4685589c564
  Cache-Control: max-age=0
  
  {"SetWizardConfig":{"wl(1).(0)_ssid":"arebwqea","wl(0).(0)_ssid":"arebwqea"}}