vulnerability_id: CVE-2020-10215
affected_vendor: D-Link
firmware_version: D-Link DIR-825
firmware_architecture: MIPS32
file_system: Squashfs
vulnerability_type: Command Injection
vulnerability_score: 8.8
vulnerability_severity: High
CWE_type: CWE-78
communication_protocol: HTTP
simulation_method: FAT
vulnerability_description: An issue was discovered on D-Link DIR-825 Rev.B 2.10 devices. They allow remote attackers to execute arbitrary commands via the dns_query_name parameter in a dns_query.cgi POST request. TRENDnet TEW-632BRP 1.010B32 is also affected.
firmware_link: ftp://ftp2.dlink.com/SECURITY_ADVISEMENTS/DIR-825/REVB/DIR-825_REVB1_FIRMWARE_PATCH_v2.10B02.zip
fuzz_seed: |-
  POST /dns_query.cgi HTTP/1.1
  Host: 192.168.0.1
  User-Agent: Mozilla/5.0 (X11; Linux aarch64; rv:78.0) Gecko/20100101 Firefox/78.0
  Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
  Accept-Language: en-US,en;q=0.5
  Accept-Encoding: gzip, deflate
  Content-Type: application/x-www-form-urlencoded
  Content-Length: 105
  Origin: http://192.168.0.1
  Connection: close
  Referer: http://192.168.0.1/adv_qos.asp
  Cookie: Authorization=Basic%20YWRtaW46MjEyMzJmMjk3YTU3YTVhNzQzODk0YTBlNGE4MDFmYzM%3D; SESSION_ID=2:1598955110:2; uid=XDgLm4A5fb; PrivateKey=217EFADEE14C4C34C281FAB5D5FA3826; PHPSESSID=c480ec2c8e0b43c89ec964533f69e373
  Upgrade-Insecure-Requests: 1
  
  html_response_page=back.asp&dns_query_name=asd&html_response_return_page=st_routing.asp&countdonw_time=12
